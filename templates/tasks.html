{% extends "base.html" %}
{% block content %}
<h1>수행평가 / 과제</h1>
<a class="btn" href="{{ url_for('index') }}">← 뒤로</a>
<div class="section">
  <h2>📌 수행평가</h2>
  {% if assessments %}
    <ul class="list">
      {% for t in assessments %}
        <li class="list-item">
          <span class="title">{{ t.title }}</span>
          <span class="date">{{ t.due_date.strftime('%Y-%m-%d') }}</span>
          {% if is_admin %}
          <form method="post" action="{{ url_for('delete_task', task_id=t.id) }}">
            <button class="btn small danger">삭제</button>
          </form>
          {% endif %}
        </li>
      {% endfor %}
    </ul>
  {% else %}
    <div class="empty">등록된 수행평가가 없습니다.</div>
  {% endif %}
</div>

<div class="section">
  <h2>📝 과제</h2>
  {% if assignments %}
    <ul class="list">
      {% for t in assignments %}
        <li class="list-item">
          <span class="title">{{ t.title }}</span>
          <span class="date">{{ t.due_date.strftime('%Y-%m-%d') }}</span>
          {% if is_admin %}
          <form method="post" action="{{ url_for('delete_task', task_id=t.id) }}">
            <button class="btn small danger">삭제</button>
          </form>
          {% endif %}
        </li>
      {% endfor %}
    </ul>
  {% else %}
    <div class="empty">등록된 과제가 없습니다.</div>
  {% endif %}
</div>

{% if is_admin %}
<div class="section">
  <h2>➕ 추가하기</h2>
  <form class="form row wrap" method="post" action="{{ url_for('add_task') }}">
    <input class="input" type="text" name="title" placeholder="제목" required>
    <input class="input" type="datetime-local" id="due_date" name="due_date" required>

<script>
  const dateInput = document.getElementById('due_date');
  const today = new Date();
  const month = String(today.getMonth() + 1).padStart(2, '0');
  const day = String(today.getDate()).padStart(2, '0');
  const hours = String(today.getHours()).padStart(2, '0');
  const minutes = String(today.getMinutes()).padStart(2, '0');

  // 기본값을 "2025-월-일T시:분"으로 설정
  dateInput.value = `2025-${month}-${day}T${hours}:${minutes}`;
  
  // 선택 가능한 날짜를 2025년으로 제한
  dateInput.min = "2025-01-01T00:00";
  dateInput.max = "2025-12-31T23:59";
</script>
    <select class="input" name="category">
      <option value="assessment">수행평가</option>
      <option value="assignment" selected>과제</option>
    </select>
    <button class="btn primary">추가</button>
  </form>
</div>
{% endif %}

{% endblock %}
