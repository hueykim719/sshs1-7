{% extends "base.html" %}
{% block content %}
<section class="stack">
  {% for n in notes %}
  <div class="card">
    <div class="row between">
      <div class="meta">{{ n.kst_str }}</div>
      <div class="row">
        {% if n.tags %}<span class="badge">#{{ n.tags }}</span>{% endif %}
        {% if n.pinned %}<span class="badge">★ 고정</span>{% endif %}
      </div>
    </div>
    <div class="note-content">{{ n.html }}</div>
    {% if n.attachment_path %}
      <div class="meta" style="margin-top:8px">
        <a href="{{ url_for('static', filename=n.attachment_path) }}" target="_blank">첨부 다운로드</a>
      </div>
    {% endif %}
    {% if is_admin %}
    <div class="row" style="margin-top:10px">
      <form method="post" action="{{ url_for('toggle_pin', note_id=n.id) }}"><button class="btn sm">고정/해제</button></form>
      <form method="post" action="{{ url_for('delete_note', note_id=n.id) }}"><button class="btn sm danger">삭제</button></form>
    </div>
    {% endif %}
  </div>
  {% else %}
    <div class="card">공지(메모)가 없습니다.</div>
  {% endfor %}
</section>

{% if is_admin %}
<div class="card">
  <h3>공지 작성</h3>
  <form class="grid2" method="post" action="{{ url_for('add_note') }}" enctype="multipart/form-data">
    <input class="inp" name="tags" placeholder="태그(쉼표로 구분)">
    <textarea class="inp" name="content" rows="4" placeholder="내용을 입력하세요"></textarea>
    <input class="inp" type="file" name="attachment" accept=".png,.jpg,.jpeg,.gif,.webp,.pdf,.doc,.docx,.ppt,.pptx,.xls,.xlsx,.zip">
    <button class="btn primary">등록</button>
  </form>
</div>
{% endif %}
{% endblock %}
